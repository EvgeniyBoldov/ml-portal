# Замечания по бэкенду - отсутствующие API эндпоинты

## Критические проблемы

### 1. Неполная реализация RAG модуля
- **Файл**: `apps/api/src/app/api/v1/routers/rag.py`
- **Реализовано**: Только `/upload/presign`
- **Отсутствует**: Большинство эндпоинтов, которые ожидает фронтенд

**Необходимо реализовать**:
- [ ] `GET /rag/` - список документов с пагинацией
- [ ] `POST /rag/upload` - загрузка файлов
- [ ] `PUT /rag/{doc_id}/tags` - обновление тегов документа
- [ ] `GET /rag/{doc_id}/progress` - прогресс обработки документа
- [ ] `GET /rag/stats` - статистика RAG
- [ ] `GET /rag/metrics` - метрики RAG
- [ ] `GET /rag/{doc_id}/download` - скачивание файла
- [ ] `POST /rag/{doc_id}/archive` - архивирование документа
- [ ] `DELETE /rag/{doc_id}` - удаление документа
- [ ] `POST /rag/search` - поиск по документам
- [ ] `POST /rag/{doc_id}/reindex` - переиндексация документа
- [ ] `POST /rag/reindex` - переиндексация всех документов

### 2. Неполная реализация Admin модуля
- **Файл**: `apps/api/src/app/api/v1/routers/admin.py`
- **Реализовано**: Только `/admin/status` и `/admin/mode`
- **Отсутствует**: Большинство admin функций

**Необходимо реализовать**:
- [ ] `GET /admin/users` - список пользователей
- [ ] `GET /admin/users/{id}` - информация о пользователе
- [ ] `POST /admin/users` - создание пользователя
- [ ] `PATCH /admin/users/{id}` - обновление пользователя
- [ ] `DELETE /admin/users/{id}` - удаление пользователя
- [ ] `POST /admin/users/{id}/password` - сброс пароля
- [ ] `GET /admin/users/{id}/tokens` - токены пользователя
- [ ] `POST /admin/users/{id}/tokens` - создание токена
- [ ] `DELETE /admin/tokens/{id}` - отзыв токена
- [ ] `GET /admin/audit-logs` - логи аудита
- [ ] `GET /admin/system/status` - статус системы

### 3. Неполная реализация Analyze модуля
- **Файл**: `apps/api/src/app/api/v1/routers/analyze.py`
- **Реализовано**: `/ingest/presign` и `/stream`
- **Отсутствует**: Основной эндпоинт `/analyze`

**Необходимо реализовать**:
- [ ] `GET /analyze` - список анализов (ожидает фронтенд)

### 4. Проблема с путями эндпоинтов чата
- **Файл**: `apps/api/src/app/api/v1/routers/chat.py`
- **Проблема**: Эндпоинты чата не имеют префикса `/chat`
- **Текущие пути**: `/chats`, `/chats/{chat_id}/messages`
- **Ожидаемые фронтом**: `/chat/chats`, `/chat/chats/{chat_id}/messages`

**Решение**: Добавить префикс `/chat` к роутеру в `apps/api/src/app/api/v1/router.py`

### 5. Проблема с роутингом
- **Файл**: `apps/api/src/app/api/v1/router.py:37`
- **Проблема**: Chat роутер монтируется с префиксом `/chat`, но эндпоинты внутри роутера не учитывают это
- **Результат**: Фактические пути `/chat/chats` вместо `/chats`

## Дополнительные проблемы

### 6. Отсутствие реализации Users модуля
- **Файл**: `apps/api/src/app/api/v1/routers/users.py`
- **Реализовано**: Только `/users/me` и начало `/users`
- **Проблема**: Неполная реализация

### 7. Отсутствие реализации Jobs модуля
- **Файл**: `apps/api/src/app/api/v1/jobs.py`
- **Реализовано**: Только начало функции `list_jobs`
- **Проблема**: Неполная реализация

### 8. Отсутствие реализации Tenants модуля
- **Файл**: `apps/api/src/app/api/v1/tenants.py`
- **Реализовано**: Только начало функций
- **Проблема**: Неполная реализация

### 9. Отсутствие реализации Models модуля
- **Файл**: `apps/api/src/app/api/v1/models.py`
- **Реализовано**: Только начало функции `list_llm_models`
- **Проблема**: Неполная реализация

## Рекомендации по исправлению

### Приоритет 1 (Критический)
1. **Исправить роутинг чата** - добавить правильный префикс
2. **Реализовать основные RAG эндпоинты** - `/rag/`, `/rag/upload`, `/rag/{doc_id}/tags`
3. **Реализовать основные admin эндпоинты** - `/admin/users`, `/admin/audit-logs`

### Приоритет 2 (Высокий)
1. **Реализовать остальные RAG функции** - поиск, метрики, статистика
2. **Реализовать остальные admin функции** - управление токенами, пользователями
3. **Реализовать analyze эндпоинт** - `/analyze`

### Приоритет 3 (Средний)
1. **Завершить реализацию Users модуля**
2. **Завершить реализацию Jobs модуля**
3. **Завершить реализацию Tenants модуля**
4. **Завершить реализацию Models модуля**

## Технические замечания

### Структура ответов
- Убедиться, что все ответы соответствуют ожиданиям фронтенда
- Использовать правильные HTTP статус коды
- Добавить валидацию входных данных

### Аутентификация и авторизация
- Проверить, что все эндпоинты правильно защищены
- Убедиться в корректной работе с токенами
- Добавить проверки прав доступа

### Обработка ошибок
- Добавить детальную обработку ошибок
- Возвращать понятные сообщения об ошибках
- Логировать ошибки для отладки
