# STAGE 00 — Правила выполнения и шаблон отчёта

## Как выполнять каждый этап
1. **Контракт-first.** Любое изменение сигнатур/путей — сначала правка `api/openapi.yaml`.
2. **Сначала тесты.** Пишем/правим тесты (unit/contract/int), потом код.
3. **Только routers.** Регистрация эндпоинтов — из `app.api.routers.*`.
4. **Удаление легаси.** Если файл помечен к удалению — удалить, не создавать дублей.
5. **Коммиты.** Мелкие, осмысленные, с ссылкой на этап и чекбоксами, что сделано.

## Как гонять тесты (в контейнере)
```bash
docker compose -f docker-compose.test.yml up -d --build
docker compose -f docker-compose.test.yml exec api pytest -m "not heavy and not e2e" -q
# полный профиль по необходимости:
docker compose -f docker-compose.test.yml exec api pytest -m "full" -q
```

## Шаблон отчёта в PR по завершении этапа
```
### Stage XX — <название>
- Тестов: <N total> / <N passed>  (coverage: <X%> если включен)
- Изменено файлов: <число>; Удалено: <список путей>
- Ключевые решения: <коротко>
- Риски/заметки: <коротко>
```
