# –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ML Portal

## üéØ –¶–µ–ª—å

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–∏—Å—Ç–µ–º—ã ML Portal. –ü–ª–∞–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω —Ç–∞–∫, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫—Ä—ã—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∞–º–∏.

## üìä –°—Ç–∞—Ç—É—Å –ø–æ–∫—Ä—ã—Ç–∏—è

### ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç —Ç–æ–ª—å–∫–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
- **Analyze Router** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- **RAG Router** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω  
- **Setup Router** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- **Password Reset Router** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- **Users Service Enhanced** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- **Base Repository** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω

### üîß –¢—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- **Admin Router** (14 —Ç–µ—Å—Ç–æ–≤)
- **Chats Router** (12 —Ç–µ—Å—Ç–æ–≤)

### ‚ùå –ù–µ –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏

#### API Routers
- `auth_router.py` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `users_router.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `health_router.py` - health checks

#### Services
- `auth_service.py` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `admin_service.py` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- `chats_service.py` - —á–∞—Ç—ã
- `analyze_service.py` - –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `clients.py` - –≤–Ω–µ—à–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—ã
- `email_service.py` - –æ—Ç–ø—Ä–∞–≤–∫–∞ email
- `file_service.py` - —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

#### Repositories
- `users_repo.py` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `chats_repo.py` - —á–∞—Ç—ã
- `rag_repo.py` - RAG –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `analyze_repo.py` - –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `tokens_repo.py` - —Ç–æ–∫–µ–Ω—ã
- `password_reset_repo.py` - —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π

#### Models
- `user_models.py` - –º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `chat_models.py` - –º–æ–¥–µ–ª–∏ —á–∞—Ç–æ–≤
- `rag_models.py` - –º–æ–¥–µ–ª–∏ RAG
- `analyze_models.py` - –º–æ–¥–µ–ª–∏ –∞–Ω–∞–ª–∏–∑–∞
- `base_models.py` - –±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏

#### Core
- `config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `database.py` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- `cache.py` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- `security.py` - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- `logging.py` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üèóÔ∏è –ü–ª–∞–Ω –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### –≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤

#### 1.1 Admin Router (`test_admin_router.py`)
**–ü—Ä–æ–±–ª–µ–º—ã**:
- –ú–æ–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç Mock –æ–±—ä–µ–∫—Ç—ã –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ assertions –¥–ª—è Pydantic –º–æ–¥–µ–ª–µ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
```python
# –í–º–µ—Å—Ç–æ:
mock_user = Mock()
mock_user.id = "user123"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
mock_user = {
    "id": "user123",
    "login": "testuser",
    "email": "test@example.com",
    "role": "reader"
}
```

#### 1.2 Chats Router (`test_chats_router.py`)
**–ü—Ä–æ–±–ª–µ–º—ã**:
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ async/await

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–∫–∏ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å async/await –≥–¥–µ –Ω—É–∂–Ω–æ

### –≠—Ç–∞–ø 2: –ù–æ–≤—ã–µ API Router —Ç–µ—Å—Ç—ã

#### 2.1 Auth Router (`test_auth_router.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ endpoints**:
- `POST /auth/login` - –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `POST /auth/logout` - –≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
- `POST /auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `GET /auth/me` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥
- –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º —Ç–æ–∫–µ–Ω–µ

#### 2.2 Users Router (`test_users_router.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ endpoints**:
- `GET /users/` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /users/{user_id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `PUT /users/{user_id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /users/{user_id}` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### 2.3 Health Router (`test_health_router.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ endpoints**:
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- `GET /health/db` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
- `GET /health/redis` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Redis
- `GET /health/s3` - –ø—Ä–æ–≤–µ—Ä–∫–∞ S3

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
- Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- S3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### –≠—Ç–∞–ø 3: Service —Ç–µ—Å—Ç—ã

#### 3.1 Auth Service (`test_auth_service.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `authenticate_user()` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `create_access_token()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `verify_token()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- `refresh_token()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
- –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

#### 3.2 Admin Service (`test_admin_service.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `create_user()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `update_user()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `delete_user()` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_user_stats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `search_users()` - –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### 3.3 Chats Service (`test_chats_service.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `create_chat()` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
- `get_chat()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–∞
- `update_chat()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- `delete_chat()` - —É–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- `add_message()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `get_messages()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

#### 3.4 Analyze Service (`test_analyze_service.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `upload_document()` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `process_document()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `get_document()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `delete_document()` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `search_documents()` - –ø–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### 3.5 Clients (`test_clients.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `qdrant_search()` - –ø–æ–∏—Å–∫ –≤ Qdrant
- `s3_upload()` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤ S3
- `s3_download()` - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑ S3
- `s3_delete()` - —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ S3

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –ü–æ–∏—Å–∫ –≤ Qdrant
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑ S3
- –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ S3
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏

### –≠—Ç–∞–ø 4: Repository —Ç–µ—Å—Ç—ã

#### 4.1 Users Repository (`test_users_repo.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `create()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_by_id()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `get_by_login()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ –ª–æ–≥–∏–Ω—É
- `get_by_email()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ email
- `update()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `delete()` - —É–¥–∞–ª–µ–Ω–∏–µ
- `search()` - –ø–æ–∏—Å–∫

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–æ–ª—è–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î

#### 4.2 Chats Repository (`test_chats_repo.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `create_chat()` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
- `get_chat()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–∞
- `update_chat()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- `delete_chat()` - —É–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
- `add_message()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `get_messages()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —á–∞—Ç–æ–≤
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

#### 4.3 RAG Repository (`test_rag_repo.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã**:
- `create_document()` - —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `get_document()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `update_document()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `delete_document()` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `search_documents()` - –ø–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è

### –≠—Ç–∞–ø 5: Model —Ç–µ—Å—Ç—ã

#### 5.1 User Models (`test_user_models.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏**:
- `User` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `UserCreate` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `UserUpdate` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `UserResponse` - –æ—Ç–≤–µ—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è email
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è

#### 5.2 Chat Models (`test_chat_models.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏**:
- `Chat` - —á–∞—Ç
- `Message` - —Å–æ–æ–±—â–µ–Ω–∏–µ
- `ChatCreate` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
- `MessageCreate` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞

### –≠—Ç–∞–ø 6: Core —Ç–µ—Å—Ç—ã

#### 6.1 Config (`test_config.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `Settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `DatabaseSettings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
- `RedisSettings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Redis
- `S3Settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ S3

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 6.2 Database (`test_database.py`)
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `get_db()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ë–î
- `init_db()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
- `close_db()` - –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏**:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üìã –®–∞–±–ª–æ–Ω—ã —Ç–µ—Å—Ç–æ–≤

### –®–∞–±–ª–æ–Ω –¥–ª—è API Router
```python
import pytest
from unittest.mock import Mock, patch
from fastapi.testclient import TestClient

class TestRouterName:
    def setup_method(self):
        self.mock_service = Mock()
        self.mock_repo = Mock()
        
    @patch('app.api.routers.router_name.service')
    def test_endpoint_success(self, mock_service):
        # Arrange
        mock_service.method.return_value = expected_result
        
        # Act
        result = endpoint_function()
        
        # Assert
        assert result == expected_result
        mock_service.method.assert_called_once_with(expected_args)
        
    @patch('app.api.routers.router_name.service')
    def test_endpoint_error(self, mock_service):
        # Arrange
        mock_service.method.side_effect = Exception("Error")
        
        # Act & Assert
        with pytest.raises(Exception):
            endpoint_function()
```

### –®–∞–±–ª–æ–Ω –¥–ª—è Service
```python
import pytest
from unittest.mock import Mock, patch

class TestServiceName:
    def setup_method(self):
        self.mock_repo = Mock()
        self.service = ServiceName(self.mock_repo)
        
    def test_method_success(self):
        # Arrange
        self.mock_repo.method.return_value = expected_result
        
        # Act
        result = self.service.method(input_data)
        
        # Assert
        assert result == expected_result
        self.mock_repo.method.assert_called_once_with(input_data)
        
    def test_method_error(self):
        # Arrange
        self.mock_repo.method.side_effect = Exception("Error")
        
        # Act & Assert
        with pytest.raises(Exception):
            self.service.method(input_data)
```

### –®–∞–±–ª–æ–Ω –¥–ª—è Repository
```python
import pytest
from unittest.mock import Mock, patch
from sqlalchemy.orm import Session

class TestRepositoryName:
    def setup_method(self):
        self.mock_db = Mock(spec=Session)
        self.repo = RepositoryName(self.mock_db)
        
    def test_method_success(self):
        # Arrange
        self.mock_db.query.return_value.filter.return_value.first.return_value = expected_result
        
        # Act
        result = self.repo.method(query_params)
        
        # Assert
        assert result == expected_result
        self.mock_db.query.assert_called_once()
        
    def test_method_not_found(self):
        # Arrange
        self.mock_db.query.return_value.filter.return_value.first.return_value = None
        
        # Act
        result = self.repo.method(query_params)
        
        # Assert
        assert result is None
```

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Admin Router (14 —Ç–µ—Å—Ç–æ–≤)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Chats Router (12 —Ç–µ—Å—Ç–æ–≤)
3. –°–æ–∑–¥–∞—Ç—å Auth Router —Ç–µ—Å—Ç—ã
4. –°–æ–∑–¥–∞—Ç—å Users Router —Ç–µ—Å—Ç—ã

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –°–æ–∑–¥–∞—Ç—å Service —Ç–µ—Å—Ç—ã
2. –°–æ–∑–¥–∞—Ç—å Repository —Ç–µ—Å—Ç—ã
3. –°–æ–∑–¥–∞—Ç—å Model —Ç–µ—Å—Ç—ã

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –°–æ–∑–¥–∞—Ç—å Core —Ç–µ—Å—Ç—ã
2. –°–æ–∑–¥–∞—Ç—å Integration —Ç–µ—Å—Ç—ã
3. –°–æ–∑–¥–∞—Ç—å E2E —Ç–µ—Å—Ç—ã

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- **Unit —Ç–µ—Å—Ç—ã**: 90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤**: 95%+
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: < 30 —Å–µ–∫—É–Ω–¥
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤**: 500+ unit —Ç–µ—Å—Ç–æ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-01-15
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π**: AI Assistant
