# ML-Portal — Чеклисты

## A. Ручки (HTTP/API)
- [ ] Один entrypoint, больше нет дубликатов.
- [ ] Везде routers‑only; контроллеры/дубли отключены.
- [ ] Формат ошибок единый (`{code,message,details}`).
- [ ] Ручки для: чат (sync/stream), RAG‑чат (sync/stream), ingest, анализ, админ/RBAC, каталог моделей.
- [ ] Паблик/интернал/админ — разведены.
- [ ] Контракт FE ↔ BE стабилен.

## B. Коннекторы
- [ ] Интерфейсы `LLMClient/EmbClient/ArtifactStore/VectorIndex` реализованы.
- [ ] Поддержаны несколько моделей и версий.
- [ ] Таймауты/ретраи/лимиты заданы.
- [ ] Прод — офлайн HF, путь к весам конфигурируемый.

## C. Модели
- [ ] DTO отделены от ML‑схем.
- [ ] Сущности согласованы: User/Tenant/Project/Roles, Provider/Model/Version, Job/Task, Document/Source, Artifact.
- [ ] Статусы/идемпотентность в нужных местах.

## D. Схемы
- [ ] Валидация входов/выходов.
- [ ] Схемы покрывают чат/стрим, RAG‑ингест/поиск/анализ, auth/RBAC/тенанты.
- [ ] FE‑клиент сгенерирован и обновлён.

## E. Логика (сервисы)
- [ ] Роутеры тонкие; бизнес‑логика в сервисах.
- [ ] `ChatService`, `RagIngestService`, `RagSearchService`, `AnalyzeService`, `AuthService` — присутствуют.
- [ ] Ингест‑пайплайн единый (parse→chunk→embed→index).

## F. Админ/RBAC
- [ ] Seed суперпользователя без ручного доступа к БД.
- [ ] Роли Viewer/Editor/Admin (+Tenant Admin).
- [ ] Права проверяются; PAT‑токены/логин работают.

## G. Наблюдаемость
- [ ] `/health` и метрики доступны.
- [ ] Корреляция по `job_id` есть.
- [ ] Формат логов единый; алёрты определены.

## H. Данные и артефакты
- [ ] `ArtifactStore`, TTL/ретеншн работают.
- [ ] Версионирование моделей/датасетов определено.
- [ ] Операции с файлами/блобами устойчивы.

## I. Фронтенд
- [ ] Типобезопасный API‑клиент подключён.
- [ ] Страницы Chat/RAG Chat/Documents/Sources/Settings присутствуют.
- [ ] SSE‑стримы отображаются корректно.

## J. CI/CD
- [ ] Быстрый профиль (без heavy) на PR.
- [ ] Полный профиль (heavy/GPU/self‑host) по расписанию/лейблу.
- [ ] Кэш pip/HF работает; артефакты/отчёты сохраняются.

---

## K. Тестовая дисциплина (каждый блок выполняется так)
- [ ] 1) Удалено легаси (дубли/устаревшие файлы).
- [ ] 2) Определены непокрытые компоненты.
- [ ] 3) Дописаны недостающие тесты (unit/int/e2e).
- [ ] 4) Прогоны тестов в контейнере (быстрый/полный).
- [ ] 5) Исправления кода до зелёного статуса.

---

## L. Пре‑мердж PR чеклист
- [ ] PR ≤ 300 строк нетривиальных изменений.
- [ ] Тесты зелёные в нужных профилях.
- [ ] Обновлена документация (при необходимости).
- [ ] Нет временных логов/комментариев/закомментированного кода.

## M. Пре‑релиз чеклист
- [ ] CHANGELOG/Release Notes заполнены.
- [ ] Миграции применены/проверены.
- [ ] Дефолтные алёрты/дашборды работают.
